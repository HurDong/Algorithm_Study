# 대여 횟수가 많은 자동차들의 월별 대여 횟수구하기

SELECT  MONTH(START_DATE) AS MONTH, CAR_ID, COUNT(*) AS RECORDS
FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY A
    JOIN (
        SELECT CAR_ID AS ID , COUNT(*) AS CNT
        FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
        WHERE YEAR(START_DATE) = 2022 AND MONTH(START_DATE) IN (8,9,10)
        GROUP BY CAR_ID
    ) SUB
        ON SUB.ID = A.CAR_ID
WHERE YEAR(START_DATE) = 2022 AND MONTH(START_DATE) IN (8,9,10) AND SUB.CNT>=5
GROUP BY 1,2
ORDER BY 1, 2 DESC